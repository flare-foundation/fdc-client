package collector_test

import (
	"testing"

	"github.com/flare-foundation/go-flare-common/pkg/database"

	"github.com/flare-foundation/fdc-client/client/collector"

	"github.com/stretchr/testify/require"
)

var policyLogs = []database.Log{
	{
		Address:         "E2c06DF29d175Aa0EcfcD10134eB96f8C94448A3",
		Data:            "0000000000000000000000009fd117be138950f714be07175c110008474b9c7d000000000000000000000000c3db96f403d7f76217d7bc85214bf113804b193c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000be10f9b415104",
		Topic0:          "824bc2cc10bfe21ead60b8c8a90716eb325b9335aa73eaede799abf38fce062c",
		Topic1:          "0x000000000000000000000000a6a088c1036f4fd6f022d52630842e19f90405ed",
		Topic2:          "0000000000000000000000000000000000000000000000000000000000000ba7",
		Topic3:          "0000000000000000000000009e283f56f1c3634aecf452411f0e9b4ab5b99088",
		TransactionHash: "ac0ad17926cd7d3cf87e53d64e9a3d83d26934c9f78a5f6bf2038732677ce235",
		LogIndex:        3,
		Timestamp:       1718191903,
		BlockNumber:     19648912,
	},
	{
		Address:         "E2c06DF29d175Aa0EcfcD10134eB96f8C94448A3",
		Data:            "000000000000000000000000b0cf50fc3af83ea9c52a957e7b58cf2f2023d626000000000000000000000000332a5a14d9fdd74652d3ee0c2841d594a30e271e1d174096b12469d0759cf61deab33d01b51b87f118cb2c256e153d25def2428005db25b146369f79c15331fcc25a068880df3402b1139cd46b4b841f904a49e70000000000000000000000000000000000000000000000000004d0bace8528ac",
		Topic0:          "824bc2cc10bfe21ead60b8c8a90716eb325b9335aa73eaede799abf38fce062c",
		Topic1:          "000000000000000000000000c21db9cb4728b86ae69b4191afb47d410e265eac",
		Topic2:          "0000000000000000000000000000000000000000000000000000000000000ba7",
		Topic3:          "000000000000000000000000c032267086b69dee29ead766b92946dfe8d99f0f",
		TransactionHash: "919acd8eedd13c6017336a4561e0c87c9e1f75b9bdd0de392c85b545ccc7f41e",
		LogIndex:        5,
		Timestamp:       1718191903,
		BlockNumber:     19648912,
	},
}

func TestBuildSubmitToSignatuer(t *testing.T) {
	subToSign, err := collector.BuildSubmitToSigningPolicyAddress(policyLogs)
	require.NoError(t, err)
	require.Equal(t, 2, len(subToSign))
}
