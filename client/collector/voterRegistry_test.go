package collector_test

import (
	"testing"

	"github.com/flare-foundation/go-flare-common/pkg/database"

	"github.com/flare-foundation/fdc-client/client/collector"

	"github.com/stretchr/testify/require"
)

var policyLogs = []database.Log{
	{
		Address:         "D4Fc541236927E2EAf8F27606bD7309C1Fc2cbee",
		Data:            "0000000000000000000000001c78a073e3bd2aca4cc327d55fb0cd4f0549b55b000000000000000000000000d3e71252f329943ddb1475d70dd4d9bef1ba5ce130783030303030303030303030303030303030303030303030303030303100003078303030303030303030303030303030303030303030303030303030320000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000130783030303030303030303030303030303030303030303030303030303300003078303030303030303030303030303030303030303030303030303030340000",
		Topic0:          "bfb6cd90b6e2668916d9e034926c84f40bcf94094b0d625ec8eecfdeb2150ae1",
		Topic1:          "00000000000000000000000092a6e1127262106611e1e129bb64b6d8654273f7",
		Topic2:          "0000000000000000000000000000000000000000000000000000000000000001",
		Topic3:          "0000000000000000000000009e283f56f1c3634aecf452411f0e9b4ab5b99088",
		TransactionHash: "383c7735b8bfd7fb9fb08de72facbc38024556209f35f2b6a9511523ea3c6d13",
		LogIndex:        3,
		Timestamp:       1718191903,
		BlockNumber:     11,
	},
	{
		Address:         "D4Fc541236927E2EAf8F27606bD7309C1Fc2cbee",
		Data:            "000000000000000000000000ded50da9c3492bee44560a4b35cfe0e778f41ec500000000000000000000000048ac463d7975828989331f4de43341627b9c5f1d30783030303030303030303030303030303030303030303030303030303200003078303030303030303030303030303030303030303030303030303030330000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000130783030303030303030303030303030303030303030303030303030303500003078303030303030303030303030303030303030303030303030303030360000",
		Topic0:          "bfb6cd90b6e2668916d9e034926c84f40bcf94094b0d625ec8eecfdeb2150ae1",
		Topic1:          "0000000000000000000000005b38da6a701c568545dcfcb03fcb875f56beddc4",
		Topic2:          "0000000000000000000000000000000000000000000000000000000000000001",
		Topic3:          "0000000000000000000000004d221261a498c83686948d4c7ce5ac397226e731",
		TransactionHash: "9d34a0fe2ca13441e0d8069fa99ba35181b351798a12cec01ad14a874db4150d",
		LogIndex:        3,
		Timestamp:       1718191903,
		BlockNumber:     11,
	},
}

func TestBuildSubmitToSignature(t *testing.T) {
	subToSign, err := collector.BuildSubmitToSigningPolicyAddress(policyLogs)
	require.NoError(t, err)
	require.Equal(t, 2, len(subToSign))
}
